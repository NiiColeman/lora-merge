2025-01-23 15:00:35,457 [INFO] 
    Summary of S-LoRA CIFAR-100 Benchmark

    1. Benchmark Setup:
    - Split CIFAR100 into 10 tasks using Avalanche
    - Each task has 10 classes with class-incremental setup

    2. SLoRA Class Structure:
    - Manages LoRA directions, alphas, and Incremental classifier + mask
    - ParameterList for alphas allows independent learning per task

    3. Training Strategy:
    - Task 0: Train LoRA direction (AB matrices) and alpha
    - Tasks 1-9: Freeze LoRA direction, only train new alpha and classifier
    - Uses masks to focus on current task classes

    4. Evaluation:
    - Tests each trained task on all previous tasks
    - Tracks accuracy using incrementally trained classifier with mask
    - Maintains running evaluation metrics

    5. Logging:
    - Timestamped files for experiment tracking
    - Records loss, accuracy, and key events
    - Uses tqdm for progress visualization

   
    
2025-01-23 15:00:35,458 [INFO] Starting S-LoRA CIFAR-100 experiment
2025-01-23 15:00:36,409 [INFO] Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-01-23 15:00:36,423 [INFO] [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-01-23 15:00:39,665 [INFO] 
Starting task 0
2025-01-23 15:00:50,529 [INFO] Task 0, Epoch 0: Loss = 1.1061, Acc = 82.30%
2025-01-23 15:00:56,609 [INFO] Task 0, Epoch 1: Loss = 0.0285, Acc = 99.40%
2025-01-23 15:01:02,670 [INFO] Task 0, Epoch 2: Loss = 0.0095, Acc = 99.80%
2025-01-23 15:01:08,725 [INFO] Task 0, Epoch 3: Loss = 0.0032, Acc = 100.00%
2025-01-23 15:01:14,782 [INFO] Task 0, Epoch 4: Loss = 0.0015, Acc = 100.00%
2025-01-23 15:01:20,841 [INFO] Task 0, Epoch 5: Loss = 0.0012, Acc = 100.00%
2025-01-23 15:01:26,900 [INFO] Task 0, Epoch 6: Loss = 0.0009, Acc = 100.00%
2025-01-23 15:01:32,961 [INFO] Task 0, Epoch 7: Loss = 0.0006, Acc = 100.00%
2025-01-23 15:01:39,017 [INFO] Task 0, Epoch 8: Loss = 0.0005, Acc = 100.00%
2025-01-23 15:01:45,078 [INFO] Task 0, Epoch 9: Loss = 0.0004, Acc = 100.00%
2025-01-23 15:01:45,079 [INFO] Task 0 completed. Average loss: 0.0004
2025-01-23 15:01:48,318 [INFO] Accuracy on task 0: 100.00%
2025-01-23 15:01:48,318 [INFO] 
Starting task 1
2025-01-23 15:01:51,681 [INFO] Task 1, Epoch 0: Loss = 1.7057, Acc = 69.40%
2025-01-23 15:01:55,054 [INFO] Task 1, Epoch 1: Loss = 0.1168, Acc = 96.90%
2025-01-23 15:01:58,463 [INFO] Task 1, Epoch 2: Loss = 0.0500, Acc = 98.80%
2025-01-23 15:02:01,847 [INFO] Task 1, Epoch 3: Loss = 0.0334, Acc = 99.70%
2025-01-23 15:02:05,216 [INFO] Task 1, Epoch 4: Loss = 0.0193, Acc = 99.90%
2025-01-23 15:02:08,585 [INFO] Task 1, Epoch 5: Loss = 0.0138, Acc = 100.00%
2025-01-23 15:02:11,972 [INFO] Task 1, Epoch 6: Loss = 0.0110, Acc = 100.00%
2025-01-23 15:02:15,371 [INFO] Task 1, Epoch 7: Loss = 0.0092, Acc = 100.00%
2025-01-23 15:02:18,747 [INFO] Task 1, Epoch 8: Loss = 0.0079, Acc = 100.00%
2025-01-23 15:02:22,136 [INFO] Task 1, Epoch 9: Loss = 0.0067, Acc = 100.00%
2025-01-23 15:02:22,136 [INFO] Task 1 completed. Average loss: 0.0067
2025-01-23 15:02:25,376 [INFO] Accuracy on task 0: 33.80%
2025-01-23 15:02:28,602 [INFO] Accuracy on task 1: 100.00%
2025-01-23 15:02:28,602 [INFO] 
Starting task 2
2025-01-23 15:02:31,955 [INFO] Task 2, Epoch 0: Loss = 1.7427, Acc = 71.90%
2025-01-23 15:02:35,364 [INFO] Task 2, Epoch 1: Loss = 0.0478, Acc = 99.20%
2025-01-23 15:02:38,751 [INFO] Task 2, Epoch 2: Loss = 0.0231, Acc = 99.70%
2025-01-23 15:02:42,145 [INFO] Task 2, Epoch 3: Loss = 0.0129, Acc = 100.00%
2025-01-23 15:02:45,551 [INFO] Task 2, Epoch 4: Loss = 0.0096, Acc = 100.00%
2025-01-23 15:02:48,961 [INFO] Task 2, Epoch 5: Loss = 0.0071, Acc = 100.00%
2025-01-23 15:02:52,376 [INFO] Task 2, Epoch 6: Loss = 0.0058, Acc = 100.00%
2025-01-23 15:02:55,778 [INFO] Task 2, Epoch 7: Loss = 0.0055, Acc = 100.00%
2025-01-23 15:02:59,180 [INFO] Task 2, Epoch 8: Loss = 0.0047, Acc = 100.00%
2025-01-23 15:03:02,585 [INFO] Task 2, Epoch 9: Loss = 0.0034, Acc = 100.00%
2025-01-23 15:03:02,585 [INFO] Task 2 completed. Average loss: 0.0034
2025-01-23 15:03:05,849 [INFO] Accuracy on task 0: 0.20%
2025-01-23 15:03:09,154 [INFO] Accuracy on task 1: 6.20%
2025-01-23 15:03:12,448 [INFO] Accuracy on task 2: 100.00%
2025-01-23 15:03:12,449 [INFO] 
Starting task 3
2025-01-23 15:03:15,828 [INFO] Task 3, Epoch 0: Loss = 1.6403, Acc = 71.10%
2025-01-23 15:03:19,204 [INFO] Task 3, Epoch 1: Loss = 0.0541, Acc = 98.80%
2025-01-23 15:03:22,567 [INFO] Task 3, Epoch 2: Loss = 0.0292, Acc = 99.20%
2025-01-23 15:03:25,930 [INFO] Task 3, Epoch 3: Loss = 0.0159, Acc = 99.90%
2025-01-23 15:03:29,297 [INFO] Task 3, Epoch 4: Loss = 0.0106, Acc = 100.00%
2025-01-23 15:03:32,651 [INFO] Task 3, Epoch 5: Loss = 0.0086, Acc = 100.00%
2025-01-23 15:03:36,020 [INFO] Task 3, Epoch 6: Loss = 0.0073, Acc = 100.00%
2025-01-23 15:03:39,387 [INFO] Task 3, Epoch 7: Loss = 0.0063, Acc = 100.00%
2025-01-23 15:03:42,749 [INFO] Task 3, Epoch 8: Loss = 0.0048, Acc = 100.00%
2025-01-23 15:03:46,096 [INFO] Task 3, Epoch 9: Loss = 0.0039, Acc = 100.00%
2025-01-23 15:03:46,096 [INFO] Task 3 completed. Average loss: 0.0039
2025-01-23 15:03:49,353 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:03:52,587 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:03:55,824 [INFO] Accuracy on task 2: 16.20%
2025-01-23 15:03:59,063 [INFO] Accuracy on task 3: 100.00%
2025-01-23 15:03:59,063 [INFO] 
Starting task 4
2025-01-23 15:04:02,434 [INFO] Task 4, Epoch 0: Loss = 1.4390, Acc = 75.60%
2025-01-23 15:04:05,791 [INFO] Task 4, Epoch 1: Loss = 0.0448, Acc = 99.20%
2025-01-23 15:04:09,154 [INFO] Task 4, Epoch 2: Loss = 0.0198, Acc = 99.80%
2025-01-23 15:04:12,525 [INFO] Task 4, Epoch 3: Loss = 0.0142, Acc = 99.90%
2025-01-23 15:04:15,884 [INFO] Task 4, Epoch 4: Loss = 0.0098, Acc = 100.00%
2025-01-23 15:04:19,252 [INFO] Task 4, Epoch 5: Loss = 0.0072, Acc = 100.00%
2025-01-23 15:04:22,618 [INFO] Task 4, Epoch 6: Loss = 0.0059, Acc = 100.00%
2025-01-23 15:04:25,981 [INFO] Task 4, Epoch 7: Loss = 0.0048, Acc = 100.00%
2025-01-23 15:04:29,348 [INFO] Task 4, Epoch 8: Loss = 0.0041, Acc = 100.00%
2025-01-23 15:04:32,714 [INFO] Task 4, Epoch 9: Loss = 0.0036, Acc = 100.00%
2025-01-23 15:04:32,719 [INFO] Task 4 completed. Average loss: 0.0036
2025-01-23 15:04:35,983 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:04:39,234 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:04:42,479 [INFO] Accuracy on task 2: 0.10%
2025-01-23 15:04:45,723 [INFO] Accuracy on task 3: 14.40%
2025-01-23 15:04:48,960 [INFO] Accuracy on task 4: 100.00%
2025-01-23 15:04:48,960 [INFO] 
Starting task 5
2025-01-23 15:04:52,333 [INFO] Task 5, Epoch 0: Loss = 1.6671, Acc = 70.20%
2025-01-23 15:04:55,694 [INFO] Task 5, Epoch 1: Loss = 0.1155, Acc = 96.70%
2025-01-23 15:04:59,057 [INFO] Task 5, Epoch 2: Loss = 0.0708, Acc = 98.10%
2025-01-23 15:05:02,417 [INFO] Task 5, Epoch 3: Loss = 0.0375, Acc = 99.30%
2025-01-23 15:05:05,779 [INFO] Task 5, Epoch 4: Loss = 0.0254, Acc = 99.70%
2025-01-23 15:05:09,138 [INFO] Task 5, Epoch 5: Loss = 0.0180, Acc = 99.80%
2025-01-23 15:05:12,493 [INFO] Task 5, Epoch 6: Loss = 0.0140, Acc = 100.00%
2025-01-23 15:05:15,848 [INFO] Task 5, Epoch 7: Loss = 0.0114, Acc = 100.00%
2025-01-23 15:05:19,205 [INFO] Task 5, Epoch 8: Loss = 0.0103, Acc = 100.00%
2025-01-23 15:05:22,560 [INFO] Task 5, Epoch 9: Loss = 0.0098, Acc = 99.90%
2025-01-23 15:05:22,560 [INFO] Task 5 completed. Average loss: 0.0098
2025-01-23 15:05:25,795 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:05:29,026 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:05:32,262 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:05:35,500 [INFO] Accuracy on task 3: 1.20%
2025-01-23 15:05:38,735 [INFO] Accuracy on task 4: 12.00%
2025-01-23 15:05:41,974 [INFO] Accuracy on task 5: 100.00%
2025-01-23 15:05:41,975 [INFO] 
Starting task 6
2025-01-23 15:05:45,337 [INFO] Task 6, Epoch 0: Loss = 1.7351, Acc = 66.80%
2025-01-23 15:05:48,696 [INFO] Task 6, Epoch 1: Loss = 0.0853, Acc = 98.00%
2025-01-23 15:05:52,052 [INFO] Task 6, Epoch 2: Loss = 0.0424, Acc = 99.20%
2025-01-23 15:05:55,409 [INFO] Task 6, Epoch 3: Loss = 0.0273, Acc = 99.90%
2025-01-23 15:05:58,766 [INFO] Task 6, Epoch 4: Loss = 0.0192, Acc = 100.00%
2025-01-23 15:06:02,124 [INFO] Task 6, Epoch 5: Loss = 0.0111, Acc = 100.00%
2025-01-23 15:06:05,484 [INFO] Task 6, Epoch 6: Loss = 0.0080, Acc = 100.00%
2025-01-23 15:06:08,841 [INFO] Task 6, Epoch 7: Loss = 0.0066, Acc = 100.00%
2025-01-23 15:06:12,197 [INFO] Task 6, Epoch 8: Loss = 0.0058, Acc = 100.00%
2025-01-23 15:06:15,549 [INFO] Task 6, Epoch 9: Loss = 0.0050, Acc = 100.00%
2025-01-23 15:06:15,549 [INFO] Task 6 completed. Average loss: 0.0050
2025-01-23 15:06:18,783 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:06:22,019 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:06:25,251 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:06:28,489 [INFO] Accuracy on task 3: 0.00%
2025-01-23 15:06:31,726 [INFO] Accuracy on task 4: 0.10%
2025-01-23 15:06:34,963 [INFO] Accuracy on task 5: 16.40%
2025-01-23 15:06:38,198 [INFO] Accuracy on task 6: 100.00%
2025-01-23 15:06:38,198 [INFO] 
Starting task 7
2025-01-23 15:06:41,551 [INFO] Task 7, Epoch 0: Loss = 1.6714, Acc = 68.00%
2025-01-23 15:06:44,907 [INFO] Task 7, Epoch 1: Loss = 0.0947, Acc = 96.80%
2025-01-23 15:06:48,264 [INFO] Task 7, Epoch 2: Loss = 0.0526, Acc = 98.80%
2025-01-23 15:06:51,621 [INFO] Task 7, Epoch 3: Loss = 0.0341, Acc = 99.60%
2025-01-23 15:06:54,975 [INFO] Task 7, Epoch 4: Loss = 0.0211, Acc = 100.00%
2025-01-23 15:06:58,330 [INFO] Task 7, Epoch 5: Loss = 0.0148, Acc = 99.90%
2025-01-23 15:07:01,687 [INFO] Task 7, Epoch 6: Loss = 0.0117, Acc = 100.00%
2025-01-23 15:07:05,044 [INFO] Task 7, Epoch 7: Loss = 0.0098, Acc = 100.00%
2025-01-23 15:07:08,405 [INFO] Task 7, Epoch 8: Loss = 0.0084, Acc = 100.00%
2025-01-23 15:07:11,763 [INFO] Task 7, Epoch 9: Loss = 0.0070, Acc = 100.00%
2025-01-23 15:07:11,763 [INFO] Task 7 completed. Average loss: 0.0070
2025-01-23 15:07:15,005 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:07:18,246 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:07:21,484 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:07:24,723 [INFO] Accuracy on task 3: 0.00%
2025-01-23 15:07:27,964 [INFO] Accuracy on task 4: 0.00%
2025-01-23 15:07:31,201 [INFO] Accuracy on task 5: 0.30%
2025-01-23 15:07:34,444 [INFO] Accuracy on task 6: 7.00%
2025-01-23 15:07:37,684 [INFO] Accuracy on task 7: 100.00%
2025-01-23 15:07:37,684 [INFO] 
Starting task 8
2025-01-23 15:07:41,046 [INFO] Task 8, Epoch 0: Loss = 1.4781, Acc = 73.30%
2025-01-23 15:07:44,402 [INFO] Task 8, Epoch 1: Loss = 0.0631, Acc = 98.50%
2025-01-23 15:07:47,761 [INFO] Task 8, Epoch 2: Loss = 0.0334, Acc = 99.30%
2025-01-23 15:07:51,114 [INFO] Task 8, Epoch 3: Loss = 0.0131, Acc = 99.90%
2025-01-23 15:07:54,470 [INFO] Task 8, Epoch 4: Loss = 0.0092, Acc = 100.00%
2025-01-23 15:07:57,829 [INFO] Task 8, Epoch 5: Loss = 0.0068, Acc = 100.00%
2025-01-23 15:08:01,192 [INFO] Task 8, Epoch 6: Loss = 0.0053, Acc = 100.00%
2025-01-23 15:08:04,551 [INFO] Task 8, Epoch 7: Loss = 0.0042, Acc = 100.00%
2025-01-23 15:08:07,914 [INFO] Task 8, Epoch 8: Loss = 0.0039, Acc = 100.00%
2025-01-23 15:08:11,275 [INFO] Task 8, Epoch 9: Loss = 0.0031, Acc = 100.00%
2025-01-23 15:08:11,275 [INFO] Task 8 completed. Average loss: 0.0031
2025-01-23 15:08:14,514 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:08:17,755 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:08:20,995 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:08:24,236 [INFO] Accuracy on task 3: 0.00%
2025-01-23 15:08:27,476 [INFO] Accuracy on task 4: 0.00%
2025-01-23 15:08:30,716 [INFO] Accuracy on task 5: 0.00%
2025-01-23 15:08:33,958 [INFO] Accuracy on task 6: 0.00%
2025-01-23 15:08:37,199 [INFO] Accuracy on task 7: 17.00%
2025-01-23 15:08:40,439 [INFO] Accuracy on task 8: 100.00%
2025-01-23 15:08:40,439 [INFO] 
Starting task 9
2025-01-23 15:08:43,807 [INFO] Task 9, Epoch 0: Loss = 1.3626, Acc = 74.70%
2025-01-23 15:08:47,171 [INFO] Task 9, Epoch 1: Loss = 0.0361, Acc = 99.10%
2025-01-23 15:08:50,533 [INFO] Task 9, Epoch 2: Loss = 0.0142, Acc = 100.00%
2025-01-23 15:08:53,899 [INFO] Task 9, Epoch 3: Loss = 0.0083, Acc = 100.00%
2025-01-23 15:08:57,283 [INFO] Task 9, Epoch 4: Loss = 0.0060, Acc = 100.00%
2025-01-23 15:09:00,652 [INFO] Task 9, Epoch 5: Loss = 0.0049, Acc = 100.00%
2025-01-23 15:09:04,021 [INFO] Task 9, Epoch 6: Loss = 0.0042, Acc = 100.00%
2025-01-23 15:09:07,392 [INFO] Task 9, Epoch 7: Loss = 0.0038, Acc = 100.00%
2025-01-23 15:09:10,762 [INFO] Task 9, Epoch 8: Loss = 0.0031, Acc = 100.00%
2025-01-23 15:09:14,131 [INFO] Task 9, Epoch 9: Loss = 0.0025, Acc = 100.00%
2025-01-23 15:09:14,131 [INFO] Task 9 completed. Average loss: 0.0025
2025-01-23 15:09:17,373 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:09:20,617 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:09:23,861 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:09:27,107 [INFO] Accuracy on task 3: 0.00%
2025-01-23 15:09:30,351 [INFO] Accuracy on task 4: 0.00%
2025-01-23 15:09:33,593 [INFO] Accuracy on task 5: 0.00%
2025-01-23 15:09:36,837 [INFO] Accuracy on task 6: 0.00%
2025-01-23 15:09:40,083 [INFO] Accuracy on task 7: 0.40%
2025-01-23 15:09:43,329 [INFO] Accuracy on task 8: 10.90%
2025-01-23 15:09:46,573 [INFO] Accuracy on task 9: 100.00%
