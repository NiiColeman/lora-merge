2025-01-23 15:06:57,656 [INFO] 
    Summary of S-LoRA CIFAR-100 Benchmark

    1. Benchmark Setup:
    - Split CIFAR100 into 10 tasks using Avalanche
    - Each task has 10 classes with class-incremental setup

    2. SLoRA Class Structure:
    - Manages LoRA directions, alphas, and Incremental classifier + mask
    - ParameterList for alphas allows independent learning per task

    3. Training Strategy:
    - Task 0: Train LoRA direction (AB matrices) and alpha
    - Tasks 1-9: Freeze LoRA direction, only train new alpha and classifier
    - Uses masks to focus on current task classes

    4. Evaluation:
    - Tests each trained task on all previous tasks
    - Tracks accuracy using incrementally trained classifier with mask
    - Maintains running evaluation metrics

    5. Logging:
    - Timestamped files for experiment tracking
    - Records loss, accuracy, and key events
    - Uses tqdm for progress visualization

   
    
2025-01-23 15:06:57,656 [INFO] Starting S-LoRA CIFAR-100 experiment
2025-01-23 15:06:58,606 [INFO] Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-01-23 15:07:01,704 [INFO] [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-01-23 15:07:04,756 [INFO] 
Starting task 0
2025-01-23 15:07:12,993 [INFO] Task 0, Epoch 0: Loss = 1.1061, Acc = 82.30%
2025-01-23 15:07:19,092 [INFO] Task 0, Epoch 1: Loss = 0.0285, Acc = 99.40%
2025-01-23 15:07:25,171 [INFO] Task 0, Epoch 2: Loss = 0.0095, Acc = 99.80%
2025-01-23 15:07:31,244 [INFO] Task 0, Epoch 3: Loss = 0.0032, Acc = 100.00%
2025-01-23 15:07:37,303 [INFO] Task 0, Epoch 4: Loss = 0.0015, Acc = 100.00%
2025-01-23 15:07:43,412 [INFO] Task 0, Epoch 5: Loss = 0.0012, Acc = 100.00%
2025-01-23 15:07:49,515 [INFO] Task 0, Epoch 6: Loss = 0.0009, Acc = 100.00%
2025-01-23 15:07:55,599 [INFO] Task 0, Epoch 7: Loss = 0.0006, Acc = 100.00%
2025-01-23 15:08:01,691 [INFO] Task 0, Epoch 8: Loss = 0.0005, Acc = 100.00%
2025-01-23 15:08:07,756 [INFO] Task 0, Epoch 9: Loss = 0.0004, Acc = 100.00%
2025-01-23 15:08:07,757 [INFO] Task 0 completed. Average loss: 0.0004
2025-01-23 15:08:11,021 [INFO] Accuracy on task 0: 100.00%
2025-01-23 15:08:11,022 [INFO] 
Starting task 1
2025-01-23 15:08:14,411 [INFO] Task 1, Epoch 0: Loss = 1.7057, Acc = 69.40%
2025-01-23 15:08:17,770 [INFO] Task 1, Epoch 1: Loss = 0.1168, Acc = 96.90%
2025-01-23 15:08:21,126 [INFO] Task 1, Epoch 2: Loss = 0.0500, Acc = 98.80%
2025-01-23 15:08:24,481 [INFO] Task 1, Epoch 3: Loss = 0.0334, Acc = 99.70%
2025-01-23 15:08:27,840 [INFO] Task 1, Epoch 4: Loss = 0.0193, Acc = 99.90%
2025-01-23 15:08:31,193 [INFO] Task 1, Epoch 5: Loss = 0.0138, Acc = 100.00%
2025-01-23 15:08:34,546 [INFO] Task 1, Epoch 6: Loss = 0.0110, Acc = 100.00%
2025-01-23 15:08:37,914 [INFO] Task 1, Epoch 7: Loss = 0.0092, Acc = 100.00%
2025-01-23 15:08:41,281 [INFO] Task 1, Epoch 8: Loss = 0.0079, Acc = 100.00%
2025-01-23 15:08:44,636 [INFO] Task 1, Epoch 9: Loss = 0.0067, Acc = 100.00%
2025-01-23 15:08:44,637 [INFO] Task 1 completed. Average loss: 0.0067
2025-01-23 15:08:47,875 [INFO] Accuracy on task 0: 33.80%
2025-01-23 15:08:51,114 [INFO] Accuracy on task 1: 100.00%
2025-01-23 15:08:51,115 [INFO] 
Starting task 2
2025-01-23 15:08:54,481 [INFO] Task 2, Epoch 0: Loss = 1.7427, Acc = 71.90%
2025-01-23 15:08:57,841 [INFO] Task 2, Epoch 1: Loss = 0.0478, Acc = 99.20%
2025-01-23 15:09:01,200 [INFO] Task 2, Epoch 2: Loss = 0.0231, Acc = 99.70%
2025-01-23 15:09:04,565 [INFO] Task 2, Epoch 3: Loss = 0.0129, Acc = 100.00%
2025-01-23 15:09:07,940 [INFO] Task 2, Epoch 4: Loss = 0.0096, Acc = 100.00%
2025-01-23 15:09:11,300 [INFO] Task 2, Epoch 5: Loss = 0.0071, Acc = 100.00%
2025-01-23 15:09:14,669 [INFO] Task 2, Epoch 6: Loss = 0.0058, Acc = 100.00%
2025-01-23 15:09:18,026 [INFO] Task 2, Epoch 7: Loss = 0.0055, Acc = 100.00%
2025-01-23 15:09:21,384 [INFO] Task 2, Epoch 8: Loss = 0.0047, Acc = 100.00%
2025-01-23 15:09:24,743 [INFO] Task 2, Epoch 9: Loss = 0.0034, Acc = 100.00%
2025-01-23 15:09:24,743 [INFO] Task 2 completed. Average loss: 0.0034
2025-01-23 15:09:27,981 [INFO] Accuracy on task 0: 0.20%
2025-01-23 15:09:31,221 [INFO] Accuracy on task 1: 6.20%
2025-01-23 15:09:34,559 [INFO] Accuracy on task 2: 100.00%
2025-01-23 15:09:34,559 [INFO] 
Starting task 3
2025-01-23 15:09:38,009 [INFO] Task 3, Epoch 0: Loss = 1.6402, Acc = 71.10%
2025-01-23 15:09:41,393 [INFO] Task 3, Epoch 1: Loss = 0.0541, Acc = 98.80%
2025-01-23 15:09:44,798 [INFO] Task 3, Epoch 2: Loss = 0.0292, Acc = 99.20%
2025-01-23 15:09:48,256 [INFO] Task 3, Epoch 3: Loss = 0.0159, Acc = 99.90%
2025-01-23 15:09:51,712 [INFO] Task 3, Epoch 4: Loss = 0.0106, Acc = 100.00%
2025-01-23 15:09:55,148 [INFO] Task 3, Epoch 5: Loss = 0.0086, Acc = 100.00%
2025-01-23 15:09:58,560 [INFO] Task 3, Epoch 6: Loss = 0.0073, Acc = 100.00%
2025-01-23 15:10:01,994 [INFO] Task 3, Epoch 7: Loss = 0.0063, Acc = 100.00%
2025-01-23 15:10:05,448 [INFO] Task 3, Epoch 8: Loss = 0.0048, Acc = 100.00%
2025-01-23 15:10:08,890 [INFO] Task 3, Epoch 9: Loss = 0.0039, Acc = 100.00%
2025-01-23 15:10:08,891 [INFO] Task 3 completed. Average loss: 0.0039
2025-01-23 15:10:12,208 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:10:15,517 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:10:18,879 [INFO] Accuracy on task 2: 16.20%
2025-01-23 15:10:22,182 [INFO] Accuracy on task 3: 100.00%
2025-01-23 15:10:22,182 [INFO] 
Starting task 4
2025-01-23 15:10:25,561 [INFO] Task 4, Epoch 0: Loss = 1.4390, Acc = 75.60%
2025-01-23 15:10:28,921 [INFO] Task 4, Epoch 1: Loss = 0.0448, Acc = 99.20%
2025-01-23 15:10:32,279 [INFO] Task 4, Epoch 2: Loss = 0.0198, Acc = 99.80%
2025-01-23 15:10:35,646 [INFO] Task 4, Epoch 3: Loss = 0.0142, Acc = 99.90%
2025-01-23 15:10:39,004 [INFO] Task 4, Epoch 4: Loss = 0.0098, Acc = 100.00%
2025-01-23 15:10:42,369 [INFO] Task 4, Epoch 5: Loss = 0.0072, Acc = 100.00%
2025-01-23 15:10:45,736 [INFO] Task 4, Epoch 6: Loss = 0.0059, Acc = 100.00%
2025-01-23 15:10:49,105 [INFO] Task 4, Epoch 7: Loss = 0.0048, Acc = 100.00%
2025-01-23 15:10:52,471 [INFO] Task 4, Epoch 8: Loss = 0.0041, Acc = 100.00%
2025-01-23 15:10:55,834 [INFO] Task 4, Epoch 9: Loss = 0.0036, Acc = 100.00%
2025-01-23 15:10:55,834 [INFO] Task 4 completed. Average loss: 0.0036
2025-01-23 15:10:59,074 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:11:02,312 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:11:05,553 [INFO] Accuracy on task 2: 0.10%
2025-01-23 15:11:08,792 [INFO] Accuracy on task 3: 14.40%
2025-01-23 15:11:12,032 [INFO] Accuracy on task 4: 100.00%
2025-01-23 15:11:12,032 [INFO] 
Starting task 5
2025-01-23 15:11:15,394 [INFO] Task 5, Epoch 0: Loss = 1.6671, Acc = 70.10%
2025-01-23 15:11:18,750 [INFO] Task 5, Epoch 1: Loss = 0.1155, Acc = 96.70%
2025-01-23 15:11:22,108 [INFO] Task 5, Epoch 2: Loss = 0.0708, Acc = 98.10%
2025-01-23 15:11:25,470 [INFO] Task 5, Epoch 3: Loss = 0.0375, Acc = 99.30%
2025-01-23 15:11:28,828 [INFO] Task 5, Epoch 4: Loss = 0.0254, Acc = 99.70%
2025-01-23 15:11:32,188 [INFO] Task 5, Epoch 5: Loss = 0.0180, Acc = 99.80%
2025-01-23 15:11:35,545 [INFO] Task 5, Epoch 6: Loss = 0.0140, Acc = 100.00%
2025-01-23 15:11:38,904 [INFO] Task 5, Epoch 7: Loss = 0.0114, Acc = 100.00%
2025-01-23 15:11:42,265 [INFO] Task 5, Epoch 8: Loss = 0.0103, Acc = 100.00%
2025-01-23 15:11:45,623 [INFO] Task 5, Epoch 9: Loss = 0.0098, Acc = 99.90%
2025-01-23 15:11:45,624 [INFO] Task 5 completed. Average loss: 0.0098
2025-01-23 15:11:48,863 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:11:52,103 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:11:55,415 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:11:58,678 [INFO] Accuracy on task 3: 1.20%
2025-01-23 15:12:01,916 [INFO] Accuracy on task 4: 12.00%
2025-01-23 15:12:05,156 [INFO] Accuracy on task 5: 100.00%
2025-01-23 15:12:05,157 [INFO] 
Starting task 6
2025-01-23 15:12:08,542 [INFO] Task 6, Epoch 0: Loss = 1.7351, Acc = 66.80%
2025-01-23 15:12:11,903 [INFO] Task 6, Epoch 1: Loss = 0.0853, Acc = 98.00%
2025-01-23 15:12:15,260 [INFO] Task 6, Epoch 2: Loss = 0.0424, Acc = 99.20%
2025-01-23 15:12:18,620 [INFO] Task 6, Epoch 3: Loss = 0.0273, Acc = 99.90%
2025-01-23 15:12:21,980 [INFO] Task 6, Epoch 4: Loss = 0.0192, Acc = 100.00%
2025-01-23 15:12:25,342 [INFO] Task 6, Epoch 5: Loss = 0.0111, Acc = 100.00%
2025-01-23 15:12:28,703 [INFO] Task 6, Epoch 6: Loss = 0.0080, Acc = 100.00%
2025-01-23 15:12:32,064 [INFO] Task 6, Epoch 7: Loss = 0.0066, Acc = 100.00%
2025-01-23 15:12:35,433 [INFO] Task 6, Epoch 8: Loss = 0.0058, Acc = 100.00%
2025-01-23 15:12:38,796 [INFO] Task 6, Epoch 9: Loss = 0.0050, Acc = 100.00%
2025-01-23 15:12:38,796 [INFO] Task 6 completed. Average loss: 0.0050
2025-01-23 15:12:42,032 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:12:45,276 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:12:48,605 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:12:51,889 [INFO] Accuracy on task 3: 0.00%
2025-01-23 15:12:55,193 [INFO] Accuracy on task 4: 0.10%
2025-01-23 15:12:58,483 [INFO] Accuracy on task 5: 16.40%
2025-01-23 15:13:01,768 [INFO] Accuracy on task 6: 100.00%
2025-01-23 15:13:01,768 [INFO] 
Starting task 7
2025-01-23 15:13:05,143 [INFO] Task 7, Epoch 0: Loss = 1.6714, Acc = 68.00%
2025-01-23 15:13:08,505 [INFO] Task 7, Epoch 1: Loss = 0.0947, Acc = 96.80%
2025-01-23 15:13:11,864 [INFO] Task 7, Epoch 2: Loss = 0.0526, Acc = 98.80%
2025-01-23 15:13:15,224 [INFO] Task 7, Epoch 3: Loss = 0.0341, Acc = 99.60%
2025-01-23 15:13:18,585 [INFO] Task 7, Epoch 4: Loss = 0.0211, Acc = 100.00%
2025-01-23 15:13:21,943 [INFO] Task 7, Epoch 5: Loss = 0.0148, Acc = 99.90%
2025-01-23 15:13:25,303 [INFO] Task 7, Epoch 6: Loss = 0.0117, Acc = 100.00%
2025-01-23 15:13:28,660 [INFO] Task 7, Epoch 7: Loss = 0.0098, Acc = 100.00%
2025-01-23 15:13:32,019 [INFO] Task 7, Epoch 8: Loss = 0.0084, Acc = 100.00%
2025-01-23 15:13:35,378 [INFO] Task 7, Epoch 9: Loss = 0.0070, Acc = 100.00%
2025-01-23 15:13:35,378 [INFO] Task 7 completed. Average loss: 0.0070
2025-01-23 15:13:38,614 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:13:41,850 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:13:45,089 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:13:48,328 [INFO] Accuracy on task 3: 0.00%
2025-01-23 15:13:51,567 [INFO] Accuracy on task 4: 0.00%
2025-01-23 15:13:54,807 [INFO] Accuracy on task 5: 0.30%
2025-01-23 15:13:58,045 [INFO] Accuracy on task 6: 7.00%
2025-01-23 15:14:01,284 [INFO] Accuracy on task 7: 100.00%
2025-01-23 15:14:01,284 [INFO] 
Starting task 8
2025-01-23 15:14:04,642 [INFO] Task 8, Epoch 0: Loss = 1.4782, Acc = 73.30%
2025-01-23 15:14:07,996 [INFO] Task 8, Epoch 1: Loss = 0.0631, Acc = 98.50%
2025-01-23 15:14:11,356 [INFO] Task 8, Epoch 2: Loss = 0.0334, Acc = 99.30%
2025-01-23 15:14:14,713 [INFO] Task 8, Epoch 3: Loss = 0.0131, Acc = 99.90%
2025-01-23 15:14:18,079 [INFO] Task 8, Epoch 4: Loss = 0.0092, Acc = 100.00%
2025-01-23 15:14:21,437 [INFO] Task 8, Epoch 5: Loss = 0.0068, Acc = 100.00%
2025-01-23 15:14:24,797 [INFO] Task 8, Epoch 6: Loss = 0.0053, Acc = 100.00%
2025-01-23 15:14:28,156 [INFO] Task 8, Epoch 7: Loss = 0.0042, Acc = 100.00%
2025-01-23 15:14:31,515 [INFO] Task 8, Epoch 8: Loss = 0.0039, Acc = 100.00%
2025-01-23 15:14:34,872 [INFO] Task 8, Epoch 9: Loss = 0.0031, Acc = 100.00%
2025-01-23 15:14:34,873 [INFO] Task 8 completed. Average loss: 0.0031
2025-01-23 15:14:38,109 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:14:41,344 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:14:44,579 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:14:47,815 [INFO] Accuracy on task 3: 0.00%
2025-01-23 15:14:51,052 [INFO] Accuracy on task 4: 0.00%
2025-01-23 15:14:54,287 [INFO] Accuracy on task 5: 0.00%
2025-01-23 15:14:57,523 [INFO] Accuracy on task 6: 0.00%
2025-01-23 15:15:00,758 [INFO] Accuracy on task 7: 17.00%
2025-01-23 15:15:03,995 [INFO] Accuracy on task 8: 100.00%
2025-01-23 15:15:03,995 [INFO] 
Starting task 9
2025-01-23 15:15:07,357 [INFO] Task 9, Epoch 0: Loss = 1.3626, Acc = 74.70%
2025-01-23 15:15:10,711 [INFO] Task 9, Epoch 1: Loss = 0.0361, Acc = 99.10%
2025-01-23 15:15:14,062 [INFO] Task 9, Epoch 2: Loss = 0.0142, Acc = 100.00%
2025-01-23 15:15:17,417 [INFO] Task 9, Epoch 3: Loss = 0.0083, Acc = 100.00%
2025-01-23 15:15:20,771 [INFO] Task 9, Epoch 4: Loss = 0.0060, Acc = 100.00%
2025-01-23 15:15:24,124 [INFO] Task 9, Epoch 5: Loss = 0.0049, Acc = 100.00%
2025-01-23 15:15:27,479 [INFO] Task 9, Epoch 6: Loss = 0.0042, Acc = 100.00%
2025-01-23 15:15:30,830 [INFO] Task 9, Epoch 7: Loss = 0.0038, Acc = 100.00%
2025-01-23 15:15:34,182 [INFO] Task 9, Epoch 8: Loss = 0.0031, Acc = 100.00%
2025-01-23 15:15:37,535 [INFO] Task 9, Epoch 9: Loss = 0.0025, Acc = 100.00%
2025-01-23 15:15:37,535 [INFO] Task 9 completed. Average loss: 0.0025
2025-01-23 15:15:40,766 [INFO] Accuracy on task 0: 0.00%
2025-01-23 15:15:44,000 [INFO] Accuracy on task 1: 0.00%
2025-01-23 15:15:47,232 [INFO] Accuracy on task 2: 0.00%
2025-01-23 15:15:50,467 [INFO] Accuracy on task 3: 0.00%
2025-01-23 15:15:53,700 [INFO] Accuracy on task 4: 0.00%
2025-01-23 15:15:56,933 [INFO] Accuracy on task 5: 0.00%
2025-01-23 15:16:00,167 [INFO] Accuracy on task 6: 0.00%
2025-01-23 15:16:03,400 [INFO] Accuracy on task 7: 0.40%
2025-01-23 15:16:06,633 [INFO] Accuracy on task 8: 10.90%
2025-01-23 15:16:09,867 [INFO] Accuracy on task 9: 100.00%
