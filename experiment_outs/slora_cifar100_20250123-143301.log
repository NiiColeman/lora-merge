2025-01-23 14:33:01,726 [INFO] 
    Summary of S-LoRA CIFAR-100 Benchmark

    1. Benchmark Setup:
    - Split CIFAR100 into 10 tasks using Avalanche
    - Each task has 10 classes with class-incremental setup

    2. SLoRA Class Structure:
    - Manages LoRA directions, alphas, and Incremental classifier + mask
    - ParameterList for alphas allows independent learning per task

    3. Training Strategy:
    - Task 0: Train LoRA direction (AB matrices) and alpha
    - Tasks 1-9: Freeze LoRA direction, only train new alpha and classifier
    - Uses masks to focus on current task classes

    4. Evaluation:
    - Tests each trained task on all previous tasks
    - Tracks accuracy using incrementally trained classifier with mask
    - Maintains running evaluation metrics

    5. Logging:
    - Timestamped files for experiment tracking
    - Records loss, accuracy, and key events
    - Uses tqdm for progress visualization

   
    
2025-01-23 14:33:01,726 [INFO] Starting S-LoRA CIFAR-100 experiment
2025-01-23 14:33:02,753 [INFO] Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-01-23 14:33:08,946 [INFO] [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-01-23 14:33:12,213 [INFO] 
Starting task 0
2025-01-23 14:33:23,248 [INFO] Task 0, Epoch 0: Loss = 1.1061, Acc = 82.30%
2025-01-23 14:33:29,469 [INFO] Task 0, Epoch 1: Loss = 0.0285, Acc = 99.40%
2025-01-23 14:33:35,681 [INFO] Task 0, Epoch 2: Loss = 0.0095, Acc = 99.80%
2025-01-23 14:33:41,879 [INFO] Task 0, Epoch 3: Loss = 0.0032, Acc = 100.00%
2025-01-23 14:33:48,078 [INFO] Task 0, Epoch 4: Loss = 0.0015, Acc = 100.00%
2025-01-23 14:33:54,285 [INFO] Task 0, Epoch 5: Loss = 0.0012, Acc = 100.00%
2025-01-23 14:34:00,516 [INFO] Task 0, Epoch 6: Loss = 0.0009, Acc = 100.00%
2025-01-23 14:34:06,719 [INFO] Task 0, Epoch 7: Loss = 0.0006, Acc = 100.00%
2025-01-23 14:34:12,933 [INFO] Task 0, Epoch 8: Loss = 0.0005, Acc = 100.00%
2025-01-23 14:34:19,131 [INFO] Task 0, Epoch 9: Loss = 0.0004, Acc = 100.00%
2025-01-23 14:34:19,132 [INFO] Task 0 completed. Average loss: 0.0004
2025-01-23 14:34:22,486 [INFO] Accuracy on task 0: 100.00%
2025-01-23 14:34:22,486 [INFO] 
Starting task 1
2025-01-23 14:34:25,920 [INFO] Task 1, Epoch 0: Loss = 1.7057, Acc = 69.40%
2025-01-23 14:34:29,346 [INFO] Task 1, Epoch 1: Loss = 0.1168, Acc = 96.90%
2025-01-23 14:34:32,774 [INFO] Task 1, Epoch 2: Loss = 0.0500, Acc = 98.80%
2025-01-23 14:34:36,204 [INFO] Task 1, Epoch 3: Loss = 0.0334, Acc = 99.70%
2025-01-23 14:34:39,636 [INFO] Task 1, Epoch 4: Loss = 0.0193, Acc = 99.90%
2025-01-23 14:34:43,060 [INFO] Task 1, Epoch 5: Loss = 0.0138, Acc = 100.00%
2025-01-23 14:34:46,488 [INFO] Task 1, Epoch 6: Loss = 0.0110, Acc = 100.00%
2025-01-23 14:34:49,915 [INFO] Task 1, Epoch 7: Loss = 0.0092, Acc = 100.00%
2025-01-23 14:34:53,347 [INFO] Task 1, Epoch 8: Loss = 0.0079, Acc = 100.00%
2025-01-23 14:34:56,776 [INFO] Task 1, Epoch 9: Loss = 0.0067, Acc = 100.00%
2025-01-23 14:34:56,777 [INFO] Task 1 completed. Average loss: 0.0067
2025-01-23 14:35:00,077 [INFO] Accuracy on task 0: 33.80%
2025-01-23 14:35:03,376 [INFO] Accuracy on task 1: 100.00%
2025-01-23 14:35:03,376 [INFO] 
Starting task 2
2025-01-23 14:35:06,803 [INFO] Task 2, Epoch 0: Loss = 1.7427, Acc = 71.90%
2025-01-23 14:35:10,230 [INFO] Task 2, Epoch 1: Loss = 0.0478, Acc = 99.20%
2025-01-23 14:35:13,655 [INFO] Task 2, Epoch 2: Loss = 0.0231, Acc = 99.70%
2025-01-23 14:35:17,076 [INFO] Task 2, Epoch 3: Loss = 0.0129, Acc = 100.00%
2025-01-23 14:35:20,499 [INFO] Task 2, Epoch 4: Loss = 0.0096, Acc = 100.00%
2025-01-23 14:35:23,928 [INFO] Task 2, Epoch 5: Loss = 0.0071, Acc = 100.00%
2025-01-23 14:35:27,339 [INFO] Task 2, Epoch 6: Loss = 0.0058, Acc = 100.00%
2025-01-23 14:35:30,753 [INFO] Task 2, Epoch 7: Loss = 0.0055, Acc = 100.00%
2025-01-23 14:35:34,181 [INFO] Task 2, Epoch 8: Loss = 0.0047, Acc = 100.00%
2025-01-23 14:35:37,609 [INFO] Task 2, Epoch 9: Loss = 0.0034, Acc = 100.00%
2025-01-23 14:35:37,609 [INFO] Task 2 completed. Average loss: 0.0034
2025-01-23 14:35:40,911 [INFO] Accuracy on task 0: 0.20%
2025-01-23 14:35:44,210 [INFO] Accuracy on task 1: 6.20%
2025-01-23 14:35:47,511 [INFO] Accuracy on task 2: 100.00%
2025-01-23 14:35:47,511 [INFO] 
Starting task 3
2025-01-23 14:35:50,938 [INFO] Task 3, Epoch 0: Loss = 1.6403, Acc = 71.10%
2025-01-23 14:35:54,362 [INFO] Task 3, Epoch 1: Loss = 0.0541, Acc = 98.80%
2025-01-23 14:35:57,787 [INFO] Task 3, Epoch 2: Loss = 0.0292, Acc = 99.20%
2025-01-23 14:36:01,212 [INFO] Task 3, Epoch 3: Loss = 0.0159, Acc = 99.90%
2025-01-23 14:36:04,639 [INFO] Task 3, Epoch 4: Loss = 0.0106, Acc = 100.00%
2025-01-23 14:36:08,067 [INFO] Task 3, Epoch 5: Loss = 0.0086, Acc = 100.00%
2025-01-23 14:36:11,490 [INFO] Task 3, Epoch 6: Loss = 0.0073, Acc = 100.00%
2025-01-23 14:36:14,919 [INFO] Task 3, Epoch 7: Loss = 0.0063, Acc = 100.00%
2025-01-23 14:36:18,347 [INFO] Task 3, Epoch 8: Loss = 0.0048, Acc = 100.00%
2025-01-23 14:36:21,771 [INFO] Task 3, Epoch 9: Loss = 0.0039, Acc = 100.00%
2025-01-23 14:36:21,772 [INFO] Task 3 completed. Average loss: 0.0039
2025-01-23 14:36:25,073 [INFO] Accuracy on task 0: 0.00%
2025-01-23 14:36:28,374 [INFO] Accuracy on task 1: 0.00%
2025-01-23 14:36:31,671 [INFO] Accuracy on task 2: 16.20%
2025-01-23 14:36:34,970 [INFO] Accuracy on task 3: 100.00%
2025-01-23 14:36:34,970 [INFO] 
Starting task 4
2025-01-23 14:36:38,392 [INFO] Task 4, Epoch 0: Loss = 1.4390, Acc = 75.60%
2025-01-23 14:36:41,808 [INFO] Task 4, Epoch 1: Loss = 0.0448, Acc = 99.20%
2025-01-23 14:36:45,224 [INFO] Task 4, Epoch 2: Loss = 0.0198, Acc = 99.80%
2025-01-23 14:36:48,651 [INFO] Task 4, Epoch 3: Loss = 0.0142, Acc = 99.90%
2025-01-23 14:36:52,075 [INFO] Task 4, Epoch 4: Loss = 0.0098, Acc = 100.00%
2025-01-23 14:36:55,503 [INFO] Task 4, Epoch 5: Loss = 0.0072, Acc = 100.00%
2025-01-23 14:36:58,930 [INFO] Task 4, Epoch 6: Loss = 0.0059, Acc = 100.00%
2025-01-23 14:37:02,357 [INFO] Task 4, Epoch 7: Loss = 0.0048, Acc = 100.00%
2025-01-23 14:37:05,785 [INFO] Task 4, Epoch 8: Loss = 0.0041, Acc = 100.00%
2025-01-23 14:37:09,211 [INFO] Task 4, Epoch 9: Loss = 0.0036, Acc = 100.00%
2025-01-23 14:37:09,211 [INFO] Task 4 completed. Average loss: 0.0036
2025-01-23 14:37:12,512 [INFO] Accuracy on task 0: 0.00%
2025-01-23 14:37:15,811 [INFO] Accuracy on task 1: 0.00%
2025-01-23 14:37:19,109 [INFO] Accuracy on task 2: 0.10%
2025-01-23 14:37:22,407 [INFO] Accuracy on task 3: 14.40%
2025-01-23 14:37:25,707 [INFO] Accuracy on task 4: 100.00%
2025-01-23 14:37:25,708 [INFO] 
Starting task 5
2025-01-23 14:37:29,137 [INFO] Task 5, Epoch 0: Loss = 1.6671, Acc = 70.10%
2025-01-23 14:37:32,551 [INFO] Task 5, Epoch 1: Loss = 0.1155, Acc = 96.70%
2025-01-23 14:37:35,973 [INFO] Task 5, Epoch 2: Loss = 0.0708, Acc = 98.10%
2025-01-23 14:37:39,403 [INFO] Task 5, Epoch 3: Loss = 0.0375, Acc = 99.30%
2025-01-23 14:37:42,831 [INFO] Task 5, Epoch 4: Loss = 0.0254, Acc = 99.70%
2025-01-23 14:37:46,260 [INFO] Task 5, Epoch 5: Loss = 0.0180, Acc = 99.80%
2025-01-23 14:37:49,688 [INFO] Task 5, Epoch 6: Loss = 0.0140, Acc = 100.00%
2025-01-23 14:37:53,118 [INFO] Task 5, Epoch 7: Loss = 0.0114, Acc = 100.00%
2025-01-23 14:37:56,547 [INFO] Task 5, Epoch 8: Loss = 0.0103, Acc = 100.00%
2025-01-23 14:37:59,977 [INFO] Task 5, Epoch 9: Loss = 0.0098, Acc = 99.90%
2025-01-23 14:37:59,977 [INFO] Task 5 completed. Average loss: 0.0098
2025-01-23 14:38:03,282 [INFO] Accuracy on task 0: 0.00%
2025-01-23 14:38:06,587 [INFO] Accuracy on task 1: 0.00%
2025-01-23 14:38:09,891 [INFO] Accuracy on task 2: 0.00%
2025-01-23 14:38:13,192 [INFO] Accuracy on task 3: 1.20%
2025-01-23 14:38:16,495 [INFO] Accuracy on task 4: 12.00%
2025-01-23 14:38:19,800 [INFO] Accuracy on task 5: 100.00%
2025-01-23 14:38:19,800 [INFO] 
Starting task 6
2025-01-23 14:38:23,228 [INFO] Task 6, Epoch 0: Loss = 1.7352, Acc = 66.80%
2025-01-23 14:38:26,661 [INFO] Task 6, Epoch 1: Loss = 0.0853, Acc = 98.00%
2025-01-23 14:38:30,090 [INFO] Task 6, Epoch 2: Loss = 0.0424, Acc = 99.20%
2025-01-23 14:38:33,518 [INFO] Task 6, Epoch 3: Loss = 0.0273, Acc = 99.90%
2025-01-23 14:38:36,948 [INFO] Task 6, Epoch 4: Loss = 0.0192, Acc = 100.00%
2025-01-23 14:38:40,378 [INFO] Task 6, Epoch 5: Loss = 0.0111, Acc = 100.00%
2025-01-23 14:38:43,807 [INFO] Task 6, Epoch 6: Loss = 0.0080, Acc = 100.00%
2025-01-23 14:38:47,237 [INFO] Task 6, Epoch 7: Loss = 0.0066, Acc = 100.00%
2025-01-23 14:38:50,668 [INFO] Task 6, Epoch 8: Loss = 0.0058, Acc = 100.00%
2025-01-23 14:38:54,101 [INFO] Task 6, Epoch 9: Loss = 0.0050, Acc = 100.00%
2025-01-23 14:38:54,101 [INFO] Task 6 completed. Average loss: 0.0050
2025-01-23 14:38:57,407 [INFO] Accuracy on task 0: 0.00%
2025-01-23 14:39:00,715 [INFO] Accuracy on task 1: 0.00%
2025-01-23 14:39:04,022 [INFO] Accuracy on task 2: 0.00%
2025-01-23 14:39:07,325 [INFO] Accuracy on task 3: 0.00%
2025-01-23 14:39:10,631 [INFO] Accuracy on task 4: 0.10%
2025-01-23 14:39:13,938 [INFO] Accuracy on task 5: 16.30%
2025-01-23 14:39:17,238 [INFO] Accuracy on task 6: 100.00%
2025-01-23 14:39:17,238 [INFO] 
Starting task 7
2025-01-23 14:39:20,667 [INFO] Task 7, Epoch 0: Loss = 1.6714, Acc = 68.00%
2025-01-23 14:39:24,082 [INFO] Task 7, Epoch 1: Loss = 0.0947, Acc = 96.80%
2025-01-23 14:39:27,512 [INFO] Task 7, Epoch 2: Loss = 0.0526, Acc = 98.80%
2025-01-23 14:39:30,941 [INFO] Task 7, Epoch 3: Loss = 0.0341, Acc = 99.60%
2025-01-23 14:39:34,367 [INFO] Task 7, Epoch 4: Loss = 0.0211, Acc = 100.00%
2025-01-23 14:39:37,793 [INFO] Task 7, Epoch 5: Loss = 0.0148, Acc = 99.90%
2025-01-23 14:39:41,218 [INFO] Task 7, Epoch 6: Loss = 0.0117, Acc = 100.00%
2025-01-23 14:39:44,642 [INFO] Task 7, Epoch 7: Loss = 0.0098, Acc = 100.00%
2025-01-23 14:39:48,067 [INFO] Task 7, Epoch 8: Loss = 0.0084, Acc = 100.00%
2025-01-23 14:39:51,493 [INFO] Task 7, Epoch 9: Loss = 0.0070, Acc = 100.00%
2025-01-23 14:39:51,494 [INFO] Task 7 completed. Average loss: 0.0070
2025-01-23 14:39:54,789 [INFO] Accuracy on task 0: 0.00%
2025-01-23 14:39:58,082 [INFO] Accuracy on task 1: 0.00%
2025-01-23 14:40:01,378 [INFO] Accuracy on task 2: 0.00%
2025-01-23 14:40:04,675 [INFO] Accuracy on task 3: 0.00%
2025-01-23 14:40:07,978 [INFO] Accuracy on task 4: 0.00%
2025-01-23 14:40:11,284 [INFO] Accuracy on task 5: 0.30%
2025-01-23 14:40:14,588 [INFO] Accuracy on task 6: 7.00%
2025-01-23 14:40:17,891 [INFO] Accuracy on task 7: 100.00%
2025-01-23 14:40:17,892 [INFO] 
Starting task 8
2025-01-23 14:40:21,322 [INFO] Task 8, Epoch 0: Loss = 1.4782, Acc = 73.30%
2025-01-23 14:40:24,750 [INFO] Task 8, Epoch 1: Loss = 0.0631, Acc = 98.50%
2025-01-23 14:40:28,182 [INFO] Task 8, Epoch 2: Loss = 0.0334, Acc = 99.30%
2025-01-23 14:40:31,613 [INFO] Task 8, Epoch 3: Loss = 0.0131, Acc = 99.90%
2025-01-23 14:40:35,046 [INFO] Task 8, Epoch 4: Loss = 0.0092, Acc = 100.00%
2025-01-23 14:40:38,477 [INFO] Task 8, Epoch 5: Loss = 0.0068, Acc = 100.00%
2025-01-23 14:40:41,908 [INFO] Task 8, Epoch 6: Loss = 0.0053, Acc = 100.00%
2025-01-23 14:40:45,339 [INFO] Task 8, Epoch 7: Loss = 0.0042, Acc = 100.00%
2025-01-23 14:40:48,773 [INFO] Task 8, Epoch 8: Loss = 0.0039, Acc = 100.00%
2025-01-23 14:40:52,202 [INFO] Task 8, Epoch 9: Loss = 0.0031, Acc = 100.00%
2025-01-23 14:40:52,202 [INFO] Task 8 completed. Average loss: 0.0031
2025-01-23 14:40:55,509 [INFO] Accuracy on task 0: 0.00%
2025-01-23 14:40:58,815 [INFO] Accuracy on task 1: 0.00%
2025-01-23 14:41:02,120 [INFO] Accuracy on task 2: 0.00%
2025-01-23 14:41:05,429 [INFO] Accuracy on task 3: 0.00%
2025-01-23 14:41:08,734 [INFO] Accuracy on task 4: 0.00%
2025-01-23 14:41:12,036 [INFO] Accuracy on task 5: 0.00%
2025-01-23 14:41:15,339 [INFO] Accuracy on task 6: 0.00%
2025-01-23 14:41:18,647 [INFO] Accuracy on task 7: 17.00%
2025-01-23 14:41:21,952 [INFO] Accuracy on task 8: 100.00%
2025-01-23 14:41:21,952 [INFO] 
Starting task 9
2025-01-23 14:41:25,377 [INFO] Task 9, Epoch 0: Loss = 1.3626, Acc = 74.70%
2025-01-23 14:41:28,808 [INFO] Task 9, Epoch 1: Loss = 0.0361, Acc = 99.10%
2025-01-23 14:41:32,238 [INFO] Task 9, Epoch 2: Loss = 0.0142, Acc = 100.00%
2025-01-23 14:41:35,670 [INFO] Task 9, Epoch 3: Loss = 0.0083, Acc = 100.00%
2025-01-23 14:41:39,104 [INFO] Task 9, Epoch 4: Loss = 0.0060, Acc = 100.00%
2025-01-23 14:41:42,528 [INFO] Task 9, Epoch 5: Loss = 0.0049, Acc = 100.00%
2025-01-23 14:41:45,948 [INFO] Task 9, Epoch 6: Loss = 0.0042, Acc = 100.00%
2025-01-23 14:41:49,380 [INFO] Task 9, Epoch 7: Loss = 0.0038, Acc = 100.00%
2025-01-23 14:41:52,813 [INFO] Task 9, Epoch 8: Loss = 0.0031, Acc = 100.00%
2025-01-23 14:41:56,244 [INFO] Task 9, Epoch 9: Loss = 0.0025, Acc = 100.00%
2025-01-23 14:41:56,245 [INFO] Task 9 completed. Average loss: 0.0025
2025-01-23 14:41:59,550 [INFO] Accuracy on task 0: 0.00%
2025-01-23 14:42:02,851 [INFO] Accuracy on task 1: 0.00%
2025-01-23 14:42:06,155 [INFO] Accuracy on task 2: 0.00%
2025-01-23 14:42:09,459 [INFO] Accuracy on task 3: 0.00%
2025-01-23 14:42:12,760 [INFO] Accuracy on task 4: 0.00%
2025-01-23 14:42:16,060 [INFO] Accuracy on task 5: 0.00%
2025-01-23 14:42:19,362 [INFO] Accuracy on task 6: 0.00%
2025-01-23 14:42:22,661 [INFO] Accuracy on task 7: 0.40%
2025-01-23 14:42:25,962 [INFO] Accuracy on task 8: 10.90%
2025-01-23 14:42:29,265 [INFO] Accuracy on task 9: 100.00%
