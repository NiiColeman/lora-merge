2025-01-24 11:52:55,056 [INFO] 
    Summary of S-DoRA CIFAR-100 Benchmark

    1. Benchmark Setup:
    - Split CIFAR100 into 10 tasks using Avalanche
    - Each task has 10 classes with class-incremental setup

    2. SLoRA Class Structure:
    - Manages LoRA directions, alphas, and Incremental classifier + mask
    - ParameterList for alphas allows independent learning per task

    3. Training Strategy:
    - Task 0: Train LoRA direction (AB matrices) and alpha
    - Tasks 1-9: Freeze LoRA direction, only train new alpha and classifier
    - Uses masks to focus on current task classes

    4. Evaluation:
    - Tests each trained task on all previous tasks
    - Tracks accuracy using incrementally trained classifier with mask
    - Maintains running evaluation metrics

    5. Logging:
    - Timestamped files for experiment tracking
    - Records loss, accuracy, and key events
    - Uses tqdm for progress visualization

   
    
2025-01-24 11:52:55,057 [INFO] Starting S-LoRA CIFAR-100 experiment
2025-01-24 11:52:56,049 [INFO] Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-01-24 11:52:56,138 [INFO] [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-01-24 11:53:02,011 [INFO] 
Starting task 0
2025-01-24 11:53:11,850 [INFO] Task 0, Epoch 0: Loss = 1.0658, Acc = 82.70%
2025-01-24 11:53:19,137 [INFO] Task 0, Epoch 1: Loss = 0.0235, Acc = 99.70%
2025-01-24 11:53:26,437 [INFO] Task 0, Epoch 2: Loss = 0.0069, Acc = 99.90%
2025-01-24 11:53:33,742 [INFO] Task 0, Epoch 3: Loss = 0.0030, Acc = 100.00%
2025-01-24 11:53:41,050 [INFO] Task 0, Epoch 4: Loss = 0.0015, Acc = 100.00%
2025-01-24 11:53:48,341 [INFO] Task 0, Epoch 5: Loss = 0.0010, Acc = 100.00%
2025-01-24 11:53:55,654 [INFO] Task 0, Epoch 6: Loss = 0.0008, Acc = 100.00%
2025-01-24 11:54:02,940 [INFO] Task 0, Epoch 7: Loss = 0.0006, Acc = 100.00%
2025-01-24 11:54:10,249 [INFO] Task 0, Epoch 8: Loss = 0.0005, Acc = 100.00%
2025-01-24 11:54:17,545 [INFO] Task 0, Epoch 9: Loss = 0.0004, Acc = 100.00%
2025-01-24 11:54:17,546 [INFO] Task 0 completed. Average loss: 0.1104
2025-01-24 11:54:21,096 [INFO] Accuracy on task 0: 100.00%
2025-01-24 11:54:21,096 [INFO] 
Starting task 1
2025-01-24 11:54:31,156 [INFO] Task 1, Epoch 0: Loss = 3.6076, Acc = 10.90%
2025-01-24 11:54:40,611 [INFO] Task 1, Epoch 1: Loss = 2.3912, Acc = 13.90%
2025-01-24 11:54:50,058 [INFO] Task 1, Epoch 2: Loss = 2.1435, Acc = 21.40%
2025-01-24 11:54:59,506 [INFO] Task 1, Epoch 3: Loss = 1.9185, Acc = 28.70%
2025-01-24 11:55:08,944 [INFO] Task 1, Epoch 4: Loss = 1.8823, Acc = 31.20%
2025-01-24 11:55:18,391 [INFO] Task 1, Epoch 5: Loss = 1.8923, Acc = 30.30%
2025-01-24 11:55:27,840 [INFO] Task 1, Epoch 6: Loss = 1.6654, Acc = 39.50%
2025-01-24 11:55:37,318 [INFO] Task 1, Epoch 7: Loss = 1.6134, Acc = 41.20%
2025-01-24 11:55:46,785 [INFO] Task 1, Epoch 8: Loss = 1.5156, Acc = 44.70%
2025-01-24 11:55:56,258 [INFO] Task 1, Epoch 9: Loss = 1.4995, Acc = 45.20%
2025-01-24 11:55:56,260 [INFO] Task 1 completed. Average loss: 2.0129
2025-01-24 11:55:59,818 [INFO] Accuracy on task 0: 0.00%
2025-01-24 11:56:03,363 [INFO] Accuracy on task 1: 46.60%
2025-01-24 11:56:03,363 [INFO] 
Starting task 2
2025-01-24 11:56:12,787 [INFO] Task 2, Epoch 0: Loss = 2.5773, Acc = 21.00%
2025-01-24 11:56:22,233 [INFO] Task 2, Epoch 1: Loss = 1.9870, Acc = 30.50%
2025-01-24 11:56:31,683 [INFO] Task 2, Epoch 2: Loss = 1.8515, Acc = 33.50%
2025-01-24 11:56:41,117 [INFO] Task 2, Epoch 3: Loss = 1.6751, Acc = 38.80%
2025-01-24 11:56:50,567 [INFO] Task 2, Epoch 4: Loss = 1.6666, Acc = 39.50%
2025-01-24 11:57:00,023 [INFO] Task 2, Epoch 5: Loss = 1.6489, Acc = 41.70%
2025-01-24 11:57:09,478 [INFO] Task 2, Epoch 6: Loss = 1.5801, Acc = 41.30%
2025-01-24 11:57:18,915 [INFO] Task 2, Epoch 7: Loss = 1.5734, Acc = 45.10%
2025-01-24 11:57:28,375 [INFO] Task 2, Epoch 8: Loss = 1.4887, Acc = 47.00%
2025-01-24 11:57:37,802 [INFO] Task 2, Epoch 9: Loss = 1.5703, Acc = 45.30%
2025-01-24 11:57:37,806 [INFO] Task 2 completed. Average loss: 1.7619
2025-01-24 11:57:41,359 [INFO] Accuracy on task 0: 0.00%
2025-01-24 11:57:44,910 [INFO] Accuracy on task 1: 0.00%
2025-01-24 11:57:48,469 [INFO] Accuracy on task 2: 55.30%
2025-01-24 11:57:48,469 [INFO] 
Starting task 3
2025-01-24 11:57:57,915 [INFO] Task 3, Epoch 0: Loss = 2.5035, Acc = 25.30%
2025-01-24 11:58:07,409 [INFO] Task 3, Epoch 1: Loss = 1.8351, Acc = 37.40%
2025-01-24 11:58:16,904 [INFO] Task 3, Epoch 2: Loss = 1.6319, Acc = 44.10%
2025-01-24 11:58:26,353 [INFO] Task 3, Epoch 3: Loss = 1.5986, Acc = 42.80%
2025-01-24 11:58:35,828 [INFO] Task 3, Epoch 4: Loss = 1.5097, Acc = 46.00%
2025-01-24 11:58:45,278 [INFO] Task 3, Epoch 5: Loss = 1.4517, Acc = 49.20%
2025-01-24 11:58:54,745 [INFO] Task 3, Epoch 6: Loss = 1.4048, Acc = 50.80%
2025-01-24 11:59:04,183 [INFO] Task 3, Epoch 7: Loss = 1.4225, Acc = 49.40%
2025-01-24 11:59:13,651 [INFO] Task 3, Epoch 8: Loss = 1.3529, Acc = 53.00%
2025-01-24 11:59:23,118 [INFO] Task 3, Epoch 9: Loss = 1.2859, Acc = 52.50%
2025-01-24 11:59:23,120 [INFO] Task 3 completed. Average loss: 1.5997
2025-01-24 11:59:26,666 [INFO] Accuracy on task 0: 0.00%
2025-01-24 11:59:30,208 [INFO] Accuracy on task 1: 0.00%
2025-01-24 11:59:33,741 [INFO] Accuracy on task 2: 0.00%
2025-01-24 11:59:37,293 [INFO] Accuracy on task 3: 63.40%
2025-01-24 11:59:37,293 [INFO] 
Starting task 4
2025-01-24 11:59:46,737 [INFO] Task 4, Epoch 0: Loss = 2.5038, Acc = 25.40%
2025-01-24 11:59:56,192 [INFO] Task 4, Epoch 1: Loss = 1.7600, Acc = 36.70%
2025-01-24 12:00:05,639 [INFO] Task 4, Epoch 2: Loss = 1.7058, Acc = 41.80%
2025-01-24 12:00:15,076 [INFO] Task 4, Epoch 3: Loss = 1.6597, Acc = 39.70%
2025-01-24 12:00:24,512 [INFO] Task 4, Epoch 4: Loss = 1.4943, Acc = 46.20%
2025-01-24 12:00:33,960 [INFO] Task 4, Epoch 5: Loss = 1.4181, Acc = 51.20%
2025-01-24 12:00:43,392 [INFO] Task 4, Epoch 6: Loss = 1.4139, Acc = 48.40%
2025-01-24 12:00:52,825 [INFO] Task 4, Epoch 7: Loss = 1.3829, Acc = 51.80%
2025-01-24 12:01:02,261 [INFO] Task 4, Epoch 8: Loss = 1.3558, Acc = 50.90%
2025-01-24 12:01:11,693 [INFO] Task 4, Epoch 9: Loss = 1.3225, Acc = 53.20%
2025-01-24 12:01:11,696 [INFO] Task 4 completed. Average loss: 1.6017
2025-01-24 12:01:15,263 [INFO] Accuracy on task 0: 0.00%
2025-01-24 12:01:18,807 [INFO] Accuracy on task 1: 0.00%
2025-01-24 12:01:22,351 [INFO] Accuracy on task 2: 0.00%
2025-01-24 12:01:25,898 [INFO] Accuracy on task 3: 0.00%
2025-01-24 12:01:29,460 [INFO] Accuracy on task 4: 54.90%
2025-01-24 12:01:29,460 [INFO] 
Starting task 5
2025-01-24 12:01:38,958 [INFO] Task 5, Epoch 0: Loss = 2.6093, Acc = 21.90%
2025-01-24 12:01:48,464 [INFO] Task 5, Epoch 1: Loss = 1.9044, Acc = 31.00%
2025-01-24 12:01:57,955 [INFO] Task 5, Epoch 2: Loss = 1.7724, Acc = 35.50%
2025-01-24 12:02:07,436 [INFO] Task 5, Epoch 3: Loss = 1.7706, Acc = 34.90%
2025-01-24 12:02:16,915 [INFO] Task 5, Epoch 4: Loss = 1.6812, Acc = 38.50%
2025-01-24 12:02:26,423 [INFO] Task 5, Epoch 5: Loss = 1.6760, Acc = 40.90%
2025-01-24 12:02:35,874 [INFO] Task 5, Epoch 6: Loss = 1.5703, Acc = 45.50%
2025-01-24 12:02:45,336 [INFO] Task 5, Epoch 7: Loss = 1.5732, Acc = 44.20%
2025-01-24 12:02:54,795 [INFO] Task 5, Epoch 8: Loss = 1.4794, Acc = 47.30%
2025-01-24 12:03:04,255 [INFO] Task 5, Epoch 9: Loss = 1.4191, Acc = 50.00%
2025-01-24 12:03:04,256 [INFO] Task 5 completed. Average loss: 1.7456
2025-01-24 12:03:07,867 [INFO] Accuracy on task 0: 0.00%
2025-01-24 12:03:11,478 [INFO] Accuracy on task 1: 0.00%
2025-01-24 12:03:15,032 [INFO] Accuracy on task 2: 0.00%
2025-01-24 12:03:18,574 [INFO] Accuracy on task 3: 0.00%
2025-01-24 12:03:22,115 [INFO] Accuracy on task 4: 0.00%
2025-01-24 12:03:25,668 [INFO] Accuracy on task 5: 56.40%
2025-01-24 12:03:25,669 [INFO] 
Starting task 6
2025-01-24 12:03:35,140 [INFO] Task 6, Epoch 0: Loss = 2.5231, Acc = 26.50%
2025-01-24 12:03:44,599 [INFO] Task 6, Epoch 1: Loss = 1.6950, Acc = 42.10%
2025-01-24 12:03:54,060 [INFO] Task 6, Epoch 2: Loss = 1.5926, Acc = 44.30%
2025-01-24 12:04:03,501 [INFO] Task 6, Epoch 3: Loss = 1.5154, Acc = 45.70%
2025-01-24 12:04:12,954 [INFO] Task 6, Epoch 4: Loss = 1.5003, Acc = 49.20%
2025-01-24 12:04:22,442 [INFO] Task 6, Epoch 5: Loss = 1.4228, Acc = 49.40%
2025-01-24 12:04:31,909 [INFO] Task 6, Epoch 6: Loss = 1.3419, Acc = 53.00%
2025-01-24 12:04:41,365 [INFO] Task 6, Epoch 7: Loss = 1.3543, Acc = 51.70%
2025-01-24 12:04:50,821 [INFO] Task 6, Epoch 8: Loss = 1.3192, Acc = 54.40%
2025-01-24 12:05:00,261 [INFO] Task 6, Epoch 9: Loss = 1.1956, Acc = 59.00%
2025-01-24 12:05:00,262 [INFO] Task 6 completed. Average loss: 1.5460
2025-01-24 12:05:03,879 [INFO] Accuracy on task 0: 0.00%
2025-01-24 12:05:07,427 [INFO] Accuracy on task 1: 0.00%
2025-01-24 12:05:10,974 [INFO] Accuracy on task 2: 0.00%
2025-01-24 12:05:14,511 [INFO] Accuracy on task 3: 0.00%
2025-01-24 12:05:18,047 [INFO] Accuracy on task 4: 0.00%
2025-01-24 12:05:21,584 [INFO] Accuracy on task 5: 0.00%
2025-01-24 12:05:25,124 [INFO] Accuracy on task 6: 62.70%
2025-01-24 12:05:25,124 [INFO] 
Starting task 7
2025-01-24 12:05:34,572 [INFO] Task 7, Epoch 0: Loss = 2.6735, Acc = 20.20%
2025-01-24 12:05:44,060 [INFO] Task 7, Epoch 1: Loss = 1.8468, Acc = 32.40%
2025-01-24 12:05:53,514 [INFO] Task 7, Epoch 2: Loss = 1.6831, Acc = 39.20%
2025-01-24 12:06:02,977 [INFO] Task 7, Epoch 3: Loss = 1.6346, Acc = 40.60%
2025-01-24 12:06:12,449 [INFO] Task 7, Epoch 4: Loss = 1.5488, Acc = 42.10%
2025-01-24 12:06:21,902 [INFO] Task 7, Epoch 5: Loss = 1.4690, Acc = 47.80%
2025-01-24 12:06:31,356 [INFO] Task 7, Epoch 6: Loss = 1.4765, Acc = 48.90%
2025-01-24 12:06:40,818 [INFO] Task 7, Epoch 7: Loss = 1.4078, Acc = 52.20%
2025-01-24 12:06:50,260 [INFO] Task 7, Epoch 8: Loss = 1.2688, Acc = 54.70%
2025-01-24 12:06:59,713 [INFO] Task 7, Epoch 9: Loss = 1.2782, Acc = 53.80%
2025-01-24 12:06:59,716 [INFO] Task 7 completed. Average loss: 1.6287
2025-01-24 12:07:03,356 [INFO] Accuracy on task 0: 0.00%
2025-01-24 12:07:06,953 [INFO] Accuracy on task 1: 0.00%
2025-01-24 12:07:10,542 [INFO] Accuracy on task 2: 0.00%
2025-01-24 12:07:14,151 [INFO] Accuracy on task 3: 0.00%
2025-01-24 12:07:17,741 [INFO] Accuracy on task 4: 0.00%
2025-01-24 12:07:21,353 [INFO] Accuracy on task 5: 0.00%
2025-01-24 12:07:24,900 [INFO] Accuracy on task 6: 0.00%
2025-01-24 12:07:28,440 [INFO] Accuracy on task 7: 57.20%
2025-01-24 12:07:28,440 [INFO] 
Starting task 8
2025-01-24 12:07:37,939 [INFO] Task 8, Epoch 0: Loss = 2.3799, Acc = 30.20%
2025-01-24 12:07:47,405 [INFO] Task 8, Epoch 1: Loss = 1.5560, Acc = 44.20%
2025-01-24 12:07:56,851 [INFO] Task 8, Epoch 2: Loss = 1.2709, Acc = 56.50%
2025-01-24 12:08:06,364 [INFO] Task 8, Epoch 3: Loss = 1.1239, Acc = 62.20%
2025-01-24 12:08:15,881 [INFO] Task 8, Epoch 4: Loss = 1.0265, Acc = 64.40%
2025-01-24 12:08:25,323 [INFO] Task 8, Epoch 5: Loss = 1.0254, Acc = 64.70%
2025-01-24 12:08:34,801 [INFO] Task 8, Epoch 6: Loss = 0.8959, Acc = 68.30%
2025-01-24 12:08:44,290 [INFO] Task 8, Epoch 7: Loss = 0.9208, Acc = 68.10%
2025-01-24 12:08:53,768 [INFO] Task 8, Epoch 8: Loss = 0.8699, Acc = 69.20%
2025-01-24 12:09:03,238 [INFO] Task 8, Epoch 9: Loss = 0.8172, Acc = 70.20%
2025-01-24 12:09:03,240 [INFO] Task 8 completed. Average loss: 1.1887
2025-01-24 12:09:06,855 [INFO] Accuracy on task 0: 0.00%
2025-01-24 12:09:10,456 [INFO] Accuracy on task 1: 0.00%
2025-01-24 12:09:14,031 [INFO] Accuracy on task 2: 0.00%
2025-01-24 12:09:17,587 [INFO] Accuracy on task 3: 0.00%
2025-01-24 12:09:21,139 [INFO] Accuracy on task 4: 0.00%
2025-01-24 12:09:24,680 [INFO] Accuracy on task 5: 0.00%
2025-01-24 12:09:28,227 [INFO] Accuracy on task 6: 0.00%
2025-01-24 12:09:31,772 [INFO] Accuracy on task 7: 0.00%
2025-01-24 12:09:35,352 [INFO] Accuracy on task 8: 77.60%
2025-01-24 12:09:35,352 [INFO] 
Starting task 9
2025-01-24 12:09:44,831 [INFO] Task 9, Epoch 0: Loss = 2.4591, Acc = 28.40%
2025-01-24 12:09:54,335 [INFO] Task 9, Epoch 1: Loss = 1.5385, Acc = 46.50%
2025-01-24 12:10:03,832 [INFO] Task 9, Epoch 2: Loss = 1.3786, Acc = 51.00%
2025-01-24 12:10:13,318 [INFO] Task 9, Epoch 3: Loss = 1.2678, Acc = 55.70%
2025-01-24 12:10:22,816 [INFO] Task 9, Epoch 4: Loss = 1.2384, Acc = 56.70%
2025-01-24 12:10:32,295 [INFO] Task 9, Epoch 5: Loss = 1.1097, Acc = 62.80%
2025-01-24 12:10:41,799 [INFO] Task 9, Epoch 6: Loss = 1.0222, Acc = 63.60%
2025-01-24 12:10:51,265 [INFO] Task 9, Epoch 7: Loss = 0.9532, Acc = 66.10%
2025-01-24 12:11:00,776 [INFO] Task 9, Epoch 8: Loss = 0.9151, Acc = 68.60%
2025-01-24 12:11:10,273 [INFO] Task 9, Epoch 9: Loss = 1.0046, Acc = 64.70%
2025-01-24 12:11:10,276 [INFO] Task 9 completed. Average loss: 1.2887
2025-01-24 12:11:13,882 [INFO] Accuracy on task 0: 0.00%
2025-01-24 12:11:17,464 [INFO] Accuracy on task 1: 0.00%
2025-01-24 12:11:21,006 [INFO] Accuracy on task 2: 0.00%
2025-01-24 12:11:24,550 [INFO] Accuracy on task 3: 0.00%
2025-01-24 12:11:28,097 [INFO] Accuracy on task 4: 0.00%
2025-01-24 12:11:31,686 [INFO] Accuracy on task 5: 0.00%
2025-01-24 12:11:35,231 [INFO] Accuracy on task 6: 0.00%
2025-01-24 12:11:38,788 [INFO] Accuracy on task 7: 0.00%
2025-01-24 12:11:42,390 [INFO] Accuracy on task 8: 0.00%
2025-01-24 12:11:46,004 [INFO] Accuracy on task 9: 76.10%
